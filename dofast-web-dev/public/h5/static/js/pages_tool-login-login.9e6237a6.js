(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages_tool-login-login"],{"013c":function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("c975"),a("a9e3"),a("ac1f"),a("5319"),a("acd8");var o={type:"scrolldone",target:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},currentTarget:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},detail:{}},i={props:{backgroundTextStyle:{type:String,default:"dark",validator:function(e){return-1!==["dark","light"].indexOf(e)}},backgroundColor:{type:String,default:"#ffffff"},backgroundColorTop:{type:String,default:"#ffffff"},backgroundColorBottom:{type:String,default:"#ffffff"},scrollTop:{type:String,default:""},scrollDuration:{type:Number,default:300},pageStyle:{type:String,default:""},enablePullDownRefresh:{type:[Boolean,String],default:!1},rootFontSize:{type:String,default:""}},created:function(){var e=this,t=getCurrentPages()[0];this.$pageVm=t.$vm||t,uni.onWindowResize((function(t){e.$emit("resize",t)})),this.$pageVm.$on("hook:onPageScroll",(function(t){e.$emit("scroll",t)})),this.$watch("backgroundTextStyle",(function(){e.setBackgroundTextStyle()})),this.$watch((function(){return[e.rootFontSize,e.pageStyle]}),(function(){e.setPageMeta()})),this.$watch((function(){return[e.backgroundColor,e.backgroundColorTop,e.backgroundColorBottom]}),(function(){e.setBackgroundColor()})),this.$watch((function(){return[e.scrollTop,e.scrollDuration]}),(function(){e.pageScrollTo()}))},beforeMount:function(){this.setBackgroundColor(),(this.rootFontSize||this.pageStyle)&&this.setPageMeta(),this.backgroundTextStyle&&this.setBackgroundTextStyle()},mounted:function(){this.scrollTop&&this.pageScrollTo()},methods:{setPullDownRefresh:function(e,t){e.setStyle({pullToRefresh:{support:t,style:"Android"===plus.os.name?"circle":"default"}})},setPageMeta:function(){uni.setPageMeta({pageStyle:this.pageStyle,rootFontSize:this.rootFontSize})},setBackgroundTextStyle:function(){},setBackgroundColor:function(){},pageScrollTo:function(){var e=this,t=String(this.scrollTop);if(-1!==t.indexOf("rpx")&&(t=uni.upx2px(t.replace("rpx",""))),t=parseFloat(t),!isNaN(t)){var a=function a(i){i.scrollTop===t&&(e.$pageVm.$off("hook:onPageScroll",a),e.$emit("scrolldone",o))};uni.pageScrollTo({scrollTop:t,duration:this.scrollDuration,success:function(){e.$pageVm.$on("hook:onPageScroll",a)}})}}}};t.default=i},"20cc":function(e,t,a){var o=a("24fb");t=o(!1),t.push([e.i,"[data-v-578ac538] .reward-popup .uni-popup__wrapper-box{background:none!important;max-width:unset!important;max-height:unset!important;overflow:unset!important}[data-v-578ac538] uni-toast .uni-simple-toast__text{background:red!important}",""]),e.exports=t},"3cef":function(e,t,a){var o=a("5d1d");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=a("4f06").default;i("324bbca6",o,!0,{sourceMap:!1,shadowMode:!1})},"5d1d":function(e,t,a){var o=a("24fb");t=o(!1),t.push([e.i,'@charset "UTF-8";\n/**\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n */[data-v-578ac538] .uni-scroll-view{background-color:#fff}[data-v-578ac538] .uni-scroll-view::-webkit-scrollbar{\n  /* 隐藏滚动条，但依旧具备可以滚动的功能 */display:none}uni-page-body[data-v-578ac538]{width:100%;background:#fff!important}body.?%PAGE?%[data-v-578ac538]{background:#fff!important}.align-right[data-v-578ac538]{color:#838383}.container[data-v-578ac538]{width:100vw;height:100vh}.header-wrap[data-v-578ac538]{width:80%;margin:calc(%?120?% + 44px) auto 0;background-repeat:no-repeat;background-size:contain;background-position:bottom;position:relative}.header-wrap .title[data-v-578ac538]{font-size:%?60?%;font-weight:700}.body-wrap[data-v-578ac538]{margin-top:%?100?%;padding-bottom:%?100?%}.body-wrap .form-wrap[data-v-578ac538]{width:80%;margin:0 auto}.body-wrap .form-wrap .input-wrap[data-v-578ac538]{position:relative;width:100%;box-sizing:border-box;height:%?60?%;margin-top:%?60?%}.body-wrap .form-wrap .input-wrap .iconfont[data-v-578ac538]{width:%?60?%;height:%?60?%;position:absolute;left:0;right:0;line-height:%?60?%;font-size:%?32?%;color:#303133;font-weight:600}.body-wrap .form-wrap .input-wrap .content[data-v-578ac538]{display:flex;height:%?60?%;border-bottom:%?2?% solid #eee;align-items:center}.body-wrap .form-wrap .input-wrap .content .input[data-v-578ac538]{flex:1;height:%?60?%;line-height:%?60?%;font-size:%?28?%}.body-wrap .form-wrap .input-wrap .content .input-placeholder[data-v-578ac538]{font-size:%?28?%;color:#bfbfbf;line-height:%?60?%}.body-wrap .form-wrap .input-wrap .content .captcha[data-v-578ac538]{margin:%?4?%;height:%?52?%;width:%?140?%}.body-wrap .form-wrap .input-wrap .content .dynacode[data-v-578ac538]{line-height:%?60?%;font-size:%?24?%}.body-wrap .form-wrap .input-wrap .content .area-code[data-v-578ac538]{line-height:%?60?%;margin-right:%?20?%;font-size:%?28?%}.body-wrap .forget-section[data-v-578ac538]{display:flex;width:80%;margin:%?40?% auto}.body-wrap .forget-section uni-view[data-v-578ac538]{flex:1;font-size:%?24?%;line-height:1}.body-wrap .btn_view[data-v-578ac538]{width:100%;margin:%?94?% auto auto;padding:0 %?30?%;box-sizing:border-box}.body-wrap .login-btn[data-v-578ac538]{height:%?90?%;line-height:%?90?%;border-radius:%?10?%;text-align:center;border:%?2?% solid;width:100%;margin:0}.body-wrap .auth-login[data-v-578ac538]{margin-top:%?20?%;width:calc(100% - %?4?%);height:%?90?%;line-height:%?90?%;border-radius:%?10?%;border:%?2?% solid;color:#fff;text-align:center;margin-left:0;background-color:#fff}.body-wrap .auth-login uni-text[data-v-578ac538]{color:#d0d0d0}.body-wrap .auth-login .iconfont[data-v-578ac538]{font-size:%?70?%}.body-wrap .auth-login .icon-weixin[data-v-578ac538]{color:#1aad19}.body-wrap .regisiter-agreement[data-v-578ac538]{text-align:center;margin-top:%?30?%;line-height:1;color:#838383;line-height:%?60?%}.body-wrap .regisiter-agreement[data-v-578ac538]{font-size:%?24?%}.login-btn-box[data-v-578ac538]{margin-top:%?50?%}.login-btn-box.active[data-v-578ac538]{margin:%?30?% 0 %?50?%}.back-btn[data-v-578ac538]{font-size:%?52?%;position:fixed;left:%?24?%;top:%?72?%;z-index:9;color:#000}.login-mode-box[data-v-578ac538]{display:flex;justify-content:flex-end;color:#909399;margin:auto;margin-top:%?44?%;font-size:%?26?%;width:80%}',""]),e.exports=t},"6d42":function(e,t,a){"use strict";a.r(t);var o=a("6ee6"),i=a("8f28");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);var r=a("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);t["default"]=c.exports},"6ee6":function(e,t,a){"use strict";a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return i})),a.d(t,"a",(function(){}));var o=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",{staticStyle:{display:"none"}},[this._t("default")],2)},i=[]},"7ece":function(e,t,a){"use strict";a.d(t,"b",(function(){return i})),a.d(t,"c",(function(){return n})),a.d(t,"a",(function(){return o}));var o={pageMeta:a("6d42").default,loadingCover:a("ed27").default,registerReward:a("6eb9").default},i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-uni-view",[a("page-meta",{attrs:{"page-style":e.themeColor}}),a("v-uni-scroll-view",{staticClass:"container",attrs:{"scroll-y":"true"}},[a("v-uni-view",{staticClass:"header-wrap"},[a("v-uni-view",{staticClass:"title"},[e._v("登录")]),""!=e.registerConfig.register?a("v-uni-view",{staticClass:"regisiter-agreement"},[a("v-uni-text",{staticClass:"color-tip"},[e._v("还没有账号,")]),a("v-uni-text",{staticClass:"color-base-text",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toRegister.apply(void 0,arguments)}}},[e._v("立即注册")])],1):e._e()],1),a("v-uni-view",{staticClass:"body-wrap"},[a("v-uni-view",{staticClass:"form-wrap"},[a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"mobile"==e.loginMode,expression:"loginMode == 'mobile'"}],staticClass:"input-wrap"},[a("v-uni-view",{staticClass:"content"},[a("v-uni-view",{staticClass:"area-code"},[e._v("+86")]),a("v-uni-input",{staticClass:"input",attrs:{type:"number",placeholder:"仅限中国大陆手机号登录","placeholder-class":"input-placeholder",maxlength:"11"},model:{value:e.formData.mobile,callback:function(t){e.$set(e.formData,"mobile",t)},expression:"formData.mobile"}})],1)],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"account"==e.loginMode,expression:"loginMode == 'account'"}],staticClass:"input-wrap"},[a("v-uni-view",{staticClass:"content"},[a("v-uni-input",{staticClass:"input",attrs:{type:"text",placeholder:"请输入账号","placeholder-class":"input-placeholder"},model:{value:e.formData.account,callback:function(t){e.$set(e.formData,"account",t)},expression:"formData.account"}})],1)],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"account"==e.loginMode,expression:"loginMode == 'account'"}],staticClass:"input-wrap"},[a("v-uni-view",{staticClass:"content"},[a("v-uni-input",{staticClass:"input",attrs:{type:"password",placeholder:"请输入密码","placeholder-class":"input-placeholder"},model:{value:e.formData.password,callback:function(t){e.$set(e.formData,"password",t)},expression:"formData.password"}}),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"account"==e.loginMode,expression:"loginMode == 'account'"}],staticClass:"align-right"},[a("v-uni-text",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.forgetPassword.apply(void 0,arguments)}}},[e._v("忘记密码?")])],1)],1)],1),1==e.captchaConfig?a("v-uni-view",{staticClass:"input-wrap"},[a("v-uni-view",{staticClass:"content"},[a("v-uni-input",{staticClass:"input",attrs:{type:"text",placeholder:"请输入验证码","placeholder-class":"input-placeholder"},model:{value:e.formData.vercode,callback:function(t){e.$set(e.formData,"vercode",t)},expression:"formData.vercode"}}),a("v-uni-image",{staticClass:"captcha",attrs:{src:e.captcha.img},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.getCaptcha.apply(void 0,arguments)}}})],1)],1):e._e(),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:"mobile"==e.loginMode,expression:"loginMode == 'mobile'"}],staticClass:"input-wrap"},[a("v-uni-view",{staticClass:"content"},[a("v-uni-input",{staticClass:"input",attrs:{type:"text",placeholder:"请输入动态码","placeholder-class":"input-placeholder"},model:{value:e.formData.dynacode,callback:function(t){e.$set(e.formData,"dynacode",t)},expression:"formData.dynacode"}}),a("v-uni-view",{staticClass:"dynacode",class:120==e.dynacodeData.seconds?"color-base-text":"color-tip",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.sendMobileCode.apply(void 0,arguments)}}},[e._v(e._s(e.dynacodeData.codeText))])],1)],1)],1),a("v-uni-view",{staticClass:"login-mode-box"},[a("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:"mobile"==e.loginMode&&-1!=e.registerConfig.login.indexOf("username"),expression:"loginMode == 'mobile' && registerConfig.login.indexOf('username') != -1"}],on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.switchLoginMode.apply(void 0,arguments)}}},[e._v("使用账号登录")]),a("v-uni-text",{directives:[{name:"show",rawName:"v-show",value:"account"==e.loginMode&&-1!=e.registerConfig.login.indexOf("mobile"),expression:"loginMode == 'account' && registerConfig.login.indexOf('mobile') != -1"}],on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.switchLoginMode.apply(void 0,arguments)}}},[e._v("使用手机号登录")])],1),a("v-uni-view",{staticClass:"btn_view"},[a("v-uni-button",{staticClass:"login-btn color-base-border color-base-bg",attrs:{type:"primary"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.login.apply(void 0,arguments)}}},[e._v("登录")])],1)],1),a("loading-cover",{ref:"loadingCover"}),a("register-reward",{ref:"registerReward"})],1)],1)},n=[]},"80c5":function(e,t,a){"use strict";a("7a82");var o=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=o(a("5530"));a("c975"),a("ac1f"),a("5319"),a("14d9"),a("b64b");var n=o(a("5411")),r=o(a("6eb9")),c=a("92e8"),s={data:function(){return{loginMode:"account",formData:{mobile:"",account:"",password:"",vercode:"",dynacode:"",key:""},captcha:{id:"",img:""},isSub:!1,back:"",redirect:"redirectTo",dynacodeData:{seconds:120,timer:null,codeText:"获取动态码",isSend:!1},registerConfig:{register:"",login:"mobile,account"},captchaConfig:0,authInfo:null}},components:{registerReward:r.default},onLoad:function(e){e.back&&(this.back=e.back),this.authInfo=uni.getStorageSync("authInfo")},onShow:function(){},onReady:function(){this.$refs.loadingCover&&this.$refs.loadingCover.hide()},methods:{getCaptchaConfig:function(){var e=this;this.$api.sendRequest({url:"/api/config/getCaptchaConfig",success:function(t){t.code>=0&&(e.captchaConfig=t.data.data.value.shop_reception_login,1==e.captchaConfig&&e.getCaptcha())}})},getRegisterConfig:function(){var e=this;this.$api.sendRequest({url:"/api/register/config",success:function(t){t.code>=0&&(e.registerConfig=t.data.value,-1!=e.registerConfig.login.indexOf("mobile")?e.loginMode="mobile":e.loginMode="account",e.$refs.loadingCover&&e.$refs.loadingCover.hide())}})},switchLoginMode:function(){this.loginMode="mobile"==this.loginMode?"account":"mobile"},getCaptcha:function(){var e=this;this.$api.sendRequest({url:"/api/captcha/captcha",data:{captcha_id:this.captcha.id},success:function(t){t.code>=0&&(e.captcha=t.data,e.captcha.img=e.captcha.img.replace(/\r\n/g,""))}})},toRegister:function(){this.back?this.$util.redirectTo("/pages_tool/login/register",{back:encodeURIComponent(this.back)}):this.$util.redirectTo("/pages_tool/login/register")},forgetPassword:function(){this.back?this.$util.redirectTo("/pages_tool/login/find",{back:encodeURIComponent(this.back)}):this.$util.redirectTo("/pages_tool/login/find")},login:function(){var e,t,a=this;if("account"==this.loginMode?("/api/login/login",e=0,t={username:this.formData.account,password:this.formData.password}):(e=1,"/api/login/mobile",t={mobile:this.formData.mobile,key:this.formData.key,code:this.formData.dynacode,socialType:10,socialCode:t.code,socialState:"9b2ffbc1-7425-4155-9894-9d5c08541d62",socialCodeValid:!0}),""!=this.captcha.id&&(t.captcha_id=this.captcha.id,t.captcha_code=this.formData.vercode),this.authInfo&&Object.assign(t,this.authInfo),uni.getStorageSync("source_member")&&(t.source_member=uni.getStorageSync("source_member")),this.verify(t)){if(this.isSub)return;this.isSub=!0,this.$api.sendRequest({url:"/api/login/login",data:{username:"15689003151",password:"123456"},success:function(e){e.code>=0&&uni.setStorage({key:"token",data:e.data.token})}}),t.mobile=t.mobile||t.username,this.$store.dispatch("Login",{type:e,data:(0,i.default)({},t)}).then((function(){a.isSub=!1,uni.$u.toast("登录成功"),setTimeout((function(){uni.switchTab({url:"/pages/index/index"})}),300)})).catch((function(){a.isSub=!1,a.getCaptcha()}))}},verify:function(e){var t=[];"mobile"==this.loginMode&&(t=[{name:"mobile",checkType:"required",errorMsg:"请输入手机号"},{name:"mobile",checkType:"phoneno",errorMsg:"请输入正确的手机号"}],1==this.captchaConfig&&""!=this.captcha.id&&t.push({name:"captcha_code",checkType:"required",errorMsg:this.$lang("captchaPlaceholder")}),t.push({name:"code",checkType:"required",errorMsg:this.$lang("dynacodePlaceholder")})),"account"==this.loginMode&&(t=[{name:"username",checkType:"required",errorMsg:this.$lang("accountPlaceholder")},{name:"password",checkType:"required",errorMsg:this.$lang("passwordPlaceholder")}],1==this.captchaConfig&&""!=this.captcha.id&&t.push({name:"captcha_code",checkType:"required",errorMsg:this.$lang("captchaPlaceholder")}));var a=n.default.check(e,t);return!!a||(this.$util.showToast({title:n.default.error}),!1)},mobileAuthLogin:function(e){var t=this;if("getPhoneNumber:ok"==e.detail.errMsg){var a={iv:e.detail.iv,encryptedData:e.detail.encryptedData};if(Object.keys(this.authInfo).length&&(Object.assign(a,this.authInfo),this.authInfo.nickName&&(a.nickname=this.authInfo.nickName),this.authInfo.avatarUrl&&(a.headimg=this.authInfo.avatarUrl)),uni.getStorageSync("source_member")&&(a.source_member=uni.getStorageSync("source_member")),this.isSub)return;this.isSub=!0,this.$api.sendRequest({url:"/api/tripartite/mobileauth",data:a,success:function(e){if(e.code>=0){var a=e.data.can_receive_registergift;uni.setStorage({key:"token",data:e.data.token,success:function(){1==a?t.$refs.registerReward.open():""!=t.back?t.$util.redirectTo(decodeURIComponent(t.back),{},t.redirect):t.$util.redirectTo("/pages/member/index",{},t.redirect)}})}else t.isSub=!1,t.$util.showToast({title:e.message})},fail:function(e){t.isSub=!1,t.$util.showToast({title:"request:fail"})}})}},sendMobileCode:function(){var e=this;if(120==this.dynacodeData.seconds&&!this.dynacodeData.isSend){var t={mobile:this.formData.mobile,captcha_id:this.captcha.id,captcha_code:this.formData.vercode},a=[{name:"mobile",checkType:"required",errorMsg:"请输入手机号"},{name:"mobile",checkType:"phoneno",errorMsg:"请输入正确的手机号"}];1==this.captchaConfig&&a.push({name:"captcha_code",checkType:"required",errorMsg:"请输入验证码"});var o=n.default.check(t,a);o?(this.dynacodeData.isSend=!0,this.dynacodeData.timer=setInterval((function(){e.dynacodeData.seconds--,e.dynacodeData.codeText=e.dynacodeData.seconds+"s后可重新获取"}),1e3),(0,c.sendSmsCode)({mobile:t.mobile,scene:1}).then((function(t){e.formData.key=t.data.key})).catch((function(t){var a;e.refreshDynacodeData(),e.$util.showToast({title:(null===(a=t.data)||void 0===a?void 0:a.msg)||t.message})}))):this.$util.showToast({title:n.default.error})}},refreshDynacodeData:function(){this.getCaptcha(),clearInterval(this.dynacodeData.timer),this.dynacodeData={seconds:120,timer:null,codeText:"获取动态码",isSend:!1}}},watch:{"dynacodeData.seconds":{handler:function(e,t){0==e&&this.refreshDynacodeData()},immediate:!0,deep:!0}}};t.default=s},"8f28":function(e,t,a){"use strict";a.r(t);var o=a("013c"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(n);t["default"]=i.a},a8d4:function(e,t,a){"use strict";a.r(t);var o=a("80c5"),i=a.n(o);for(var n in o)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return o[e]}))}(n);t["default"]=i.a},bebe:function(e,t,a){"use strict";a.r(t);var o=a("7ece"),i=a("a8d4");for(var n in i)["default"].indexOf(n)<0&&function(e){a.d(t,e,(function(){return i[e]}))}(n);a("d33d"),a("c713");var r=a("f0c5"),c=Object(r["a"])(i["default"],o["b"],o["c"],!1,null,"578ac538",null,!1,o["a"],void 0);t["default"]=c.exports},c513c:function(e,t,a){var o=a("20cc");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[e.i,o,""]]),o.locals&&(e.exports=o.locals);var i=a("4f06").default;i("6f096561",o,!0,{sourceMap:!1,shadowMode:!1})},c713:function(e,t,a){"use strict";var o=a("c513c"),i=a.n(o);i.a},d33d:function(e,t,a){"use strict";var o=a("3cef"),i=a.n(o);i.a}}]);