(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages_tool-chat-room"],{"013c":function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c975"),i("a9e3"),i("ac1f"),i("5319"),i("acd8");var o={type:"scrolldone",target:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},currentTarget:{id:"",offsetLeft:0,offsetTop:0,dataset:{}},detail:{}},s={props:{backgroundTextStyle:{type:String,default:"dark",validator:function(t){return-1!==["dark","light"].indexOf(t)}},backgroundColor:{type:String,default:"#ffffff"},backgroundColorTop:{type:String,default:"#ffffff"},backgroundColorBottom:{type:String,default:"#ffffff"},scrollTop:{type:String,default:""},scrollDuration:{type:Number,default:300},pageStyle:{type:String,default:""},enablePullDownRefresh:{type:[Boolean,String],default:!1},rootFontSize:{type:String,default:""}},created:function(){var t=this,e=getCurrentPages()[0];this.$pageVm=e.$vm||e,uni.onWindowResize((function(e){t.$emit("resize",e)})),this.$pageVm.$on("hook:onPageScroll",(function(e){t.$emit("scroll",e)})),this.$watch("backgroundTextStyle",(function(){t.setBackgroundTextStyle()})),this.$watch((function(){return[t.rootFontSize,t.pageStyle]}),(function(){t.setPageMeta()})),this.$watch((function(){return[t.backgroundColor,t.backgroundColorTop,t.backgroundColorBottom]}),(function(){t.setBackgroundColor()})),this.$watch((function(){return[t.scrollTop,t.scrollDuration]}),(function(){t.pageScrollTo()}))},beforeMount:function(){this.setBackgroundColor(),(this.rootFontSize||this.pageStyle)&&this.setPageMeta(),this.backgroundTextStyle&&this.setBackgroundTextStyle()},mounted:function(){this.scrollTop&&this.pageScrollTo()},methods:{setPullDownRefresh:function(t,e){t.setStyle({pullToRefresh:{support:e,style:"Android"===plus.os.name?"circle":"default"}})},setPageMeta:function(){uni.setPageMeta({pageStyle:this.pageStyle,rootFontSize:this.rootFontSize})},setBackgroundTextStyle:function(){},setBackgroundColor:function(){},pageScrollTo:function(){var t=this,e=String(this.scrollTop);if(-1!==e.indexOf("rpx")&&(e=uni.upx2px(e.replace("rpx",""))),e=parseFloat(e),!isNaN(e)){var i=function i(s){s.scrollTop===e&&(t.$pageVm.$off("hook:onPageScroll",i),t.$emit("scrolldone",o))};uni.pageScrollTo({scrollTop:e,duration:this.scrollDuration,success:function(){t.$pageVm.$on("hook:onPageScroll",i)}})}}}};e.default=s},"02e8":function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("a9e3");var o={name:"ns-chat-goods",props:{skuId:{type:[Number,String]},goodsDetail:{type:[Object]}},data:function(){return{goodsInfo:{}}},mounted:function(){this.getGoodsInfo()},methods:{getGoodsInfo:function(){var t=this;this.$api.sendRequest({url:"/api/goodssku/detail",data:{sku_id:this.skuId},success:function(e){e.code>=0&&(t.goodsInfo=e.data.goods_sku_detail)}})},sendMsg:function(){this.$emit("sendMsg","goods")}}};e.default=o},1247:function(t,e,i){"use strict";(function(t){i("7a82");var o=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("c975"),i("ac1f"),i("466d"),i("5319"),i("4d63"),i("c607"),i("2c3e"),i("25f0"),i("14d9"),i("13d5"),i("d3b7"),i("3c65");var s=o(i("9fff")),a=/^<([-A-Za-z0-9_]+)((?:\s+[a-zA-Z_:][-a-zA-Z0-9_:.]*(?:\s*=\s*(?:(?:"[^"]*")|(?:'[^']*')|[^>\s]+))?)*)\s*(\/?)>/,n=/^<\/([-A-Za-z0-9_]+)[^>]*>/,r=/([a-zA-Z_:][-a-zA-Z0-9_:.]*)(?:\s*=\s*(?:(?:"((?:\\.|[^"])*)")|(?:'((?:\\.|[^'])*)')|([^>\s]+)))?/g,d=m("area,base,basefont,br,col,frame,hr,img,input,link,meta,param,embed,command,keygen,source,track,wbr"),c=m("a,address,article,applet,aside,audio,blockquote,button,canvas,center,dd,del,dir,div,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video"),u=m("abbr,acronym,applet,b,basefont,bdo,big,br,button,cite,code,del,dfn,em,font,i,iframe,img,input,ins,kbd,label,map,object,q,s,samp,script,select,small,span,strike,strong,sub,sup,textarea,tt,u,var"),l=m("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr"),g=m("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected"),f=m("script,style");function m(t){for(var e={},i=t.split(","),o=0;o<i.length;o++)e[i[o]]=!0;return e}var p=function(e){e=function(t){return t.replace(/<\?xml.*\?>\n/,"").replace(/<!doctype.*>\n/,"").replace(/<!DOCTYPE.*>\n/,"")}(e),e=function(t){return t=t.replace(/<!--[\s\S]*-->/gi,""),t}(e),e=function(t){var e='<img style="width:100% !important;display:block;max-width: '.concat("100%",' !important;"');return t=t.replace(/\\/g,"").replace(/<img/g,e),t=t.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/gi,(function(t,i){return e+' src="'+s.default.img(i)+'"/>'})),t}(e),e=function(t){return t=t.replace(/style\s*=\s*["][^>]*;[^"]?/gi,(function(t,e){return t=t.replace(/[:](\s?)[\s\S]*/gi,(function(t,e){return t.replace(/"/g,"'")})),t})),t}(e);var i=[],o={node:"root",children:[]};return function(t,e){var i,o,s,m=[],p=t;m.last=function(){return this[this.length-1]};while(t){if(o=!0,m.last()&&f[m.last()])t=t.replace(new RegExp("([\\s\\S]*?)</"+m.last()+"[^>]*>"),(function(t,i){return i=i.replace(/<!--([\s\S]*?)-->|<!\[CDATA\[([\s\S]*?)]]>/g,"$1$2"),e.chars&&e.chars(i),""})),y("",m.last());else if(0==t.indexOf("\x3c!--")?(i=t.indexOf("--\x3e"),i>=0&&(e.comment&&e.comment(t.substring(4,i)),t=t.substring(i+3),o=!1)):0==t.indexOf("</")?(s=t.match(n),s&&(t=t.substring(s[0].length),s[0].replace(n,y),o=!1)):0==t.indexOf("<")&&(s=t.match(a),s&&(t=t.substring(s[0].length),s[0].replace(a,v),o=!1)),o){i=t.indexOf("<");var h=i<0?t:t.substring(0,i);t=i<0?"":t.substring(i),e.chars&&e.chars(h)}if(t==p)throw"Parse Error: "+t;p=t}function v(t,i,o,s){if(i=i.toLowerCase(),c[i])while(m.last()&&u[m.last()])y("",m.last());if(l[i]&&m.last()==i&&y("",i),s=d[i]||!!s,s||m.push(i),e.start){var a=[];o.replace(r,(function(t,e){var i=arguments[2]?arguments[2]:arguments[3]?arguments[3]:arguments[4]?arguments[4]:g[e]?e:"";a.push({name:e,value:i,escaped:i.replace(/(^|[^\\])"/g,'$1\\"')})})),e.start&&e.start(i,a,s)}}function y(t,i){if(i){for(o=m.length-1;o>=0;o--)if(m[o]==i)break}else var o=0;if(o>=0){for(var s=m.length-1;s>=o;s--)e.end&&e.end(m[s]);m.length=o}}y()}(e,{start:function(t,e,s){var a={name:t};if(0!==e.length&&(a.attrs=function(t){return t.reduce((function(t,e){var i=e.value,o=e.name;return t[o]?t[o]=t[o]+" "+i:t[o]=i,t}),{})}(e)),s){var n=i[0]||o;n.children||(n.children=[]),n.children.push(a)}else i.unshift(a)},end:function(e){var s=i.shift();if(s.name!==e&&t("error","invalid state: mismatch end tag"," at common/js/html-parser.js:354"),0===i.length)o.children.push(s);else{var a=i[0];a.children||(a.children=[]),a.children.push(s)}},chars:function(t){var e={type:"text",text:t};if(0===i.length)o.children.push(e);else{var s=i[0];s.children||(s.children=[]),s.children.push(e)}},comment:function(t){var e={node:"comment",text:t},o=i[0];o.children||(o.children=[]),o.children.push(e)}}),o.children};e.default=p}).call(this,i("0de9")["log"])},1595:function(t,e,i){var o=i("f3b4");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var s=i("4f06").default;s("26fb95dd",o,!0,{sourceMap:!1,shadowMode:!1})},"1e21":function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n */.message[data-v-6600fb05]{padding:%?13?% %?20?%;box-sizing:border-box;width:100vw;position:relative}.message .goods-item[data-v-6600fb05]{width:100%;height:%?220?%;background:#fff;position:relative;display:flex;align-items:center;border-radius:%?20?%;margin:0 auto;padding:%?20?%;box-sizing:border-box}.message .goods-item uni-image[data-v-6600fb05]{width:%?180?%;height:%?180?%}.message .goods-item .goods-info[data-v-6600fb05]{width:100%;height:%?180?%;display:flex;flex-direction:column;justify-content:space-between;padding-left:%?20?%;box-sizing:border-box}.message .goods-item .goods-info .goods-name[data-v-6600fb05]{width:100%;line-height:1.4;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:1;overflow:hidden;margin-bottom:%?10?%}.message .goods-item .goods-info .goods-bottom[data-v-6600fb05]{display:flex;justify-content:space-between;align-items:flex-end}.message .goods-item .goods-info .goods-bottom uni-text[data-v-6600fb05]{line-height:1}.message .goods-item .goods-info .goods-bottom .goods-price[data-v-6600fb05]{display:flex;align-items:flex-end;padding-bottom:%?10?%;font-weight:500}.message .goods-item .goods-info .goods-bottom .goods-price .goods-price-sign[data-v-6600fb05]{font-size:%?20?%}.message .goods-item .goods-info .goods-bottom .goods-option[data-v-6600fb05]{width:%?150?%;height:%?50?%;line-height:%?50?%;text-align:center;border-radius:%?10?%;color:#fff}.message .goods-item .disabled[data-v-6600fb05]{background:#e5e5e5}',""]),t.exports=e},"1fd3":function(t,e,i){"use strict";var o=i("3a52"),s=i.n(o);s.a},"21ef":function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;e.default={emjoyList:{"[emjoy_01]":"public/static/img/emjoy/emjoy_01.gif","[emjoy_02]":"public/static/img/emjoy/emjoy_02.gif","[emjoy_03]":"public/static/img/emjoy/emjoy_03.gif","[emjoy_04]":"public/static/img/emjoy/emjoy_04.gif","[emjoy_05]":"public/static/img/emjoy/emjoy_05.gif","[emjoy_06]":"public/static/img/emjoy/emjoy_06.gif","[emjoy_07]":"public/static/img/emjoy/emjoy_07.gif","[emjoy_08]":"public/static/img/emjoy/emjoy_08.gif","[emjoy_09]":"public/static/img/emjoy/emjoy_09.gif","[emjoy_10]":"public/static/img/emjoy/emjoy_10.gif","[emjoy_11]":"public/static/img/emjoy/emjoy_11.gif","[emjoy_12]":"public/static/img/emjoy/emjoy_12.gif","[emjoy_13]":"public/static/img/emjoy/emjoy_13.gif","[emjoy_14]":"public/static/img/emjoy/emjoy_14.gif","[emjoy_15]":"public/static/img/emjoy/emjoy_15.gif","[emjoy_16]":"public/static/img/emjoy/emjoy_16.gif","[emjoy_17]":"public/static/img/emjoy/emjoy_17.gif","[emjoy_18]":"public/static/img/emjoy/emjoy_18.gif","[emjoy_19]":"public/static/img/emjoy/emjoy_19.gif","[emjoy_20]":"public/static/img/emjoy/emjoy_20.gif","[emjoy_21]":"public/static/img/emjoy/emjoy_21.gif","[emjoy_22]":"public/static/img/emjoy/emjoy_22.gif","[emjoy_23]":"public/static/img/emjoy/emjoy_23.gif","[emjoy_24]":"public/static/img/emjoy/emjoy_24.gif","[emjoy_25]":"public/static/img/emjoy/emjoy_25.gif","[emjoy_26]":"public/static/img/emjoy/emjoy_26.gif","[emjoy_27]":"public/static/img/emjoy/emjoy_27.gif","[emjoy_28]":"public/static/img/emjoy/emjoy_28.gif","[emjoy_29]":"public/static/img/emjoy/emjoy_29.gif","[emjoy_30]":"public/static/img/emjoy/emjoy_30.gif","[emjoy_31]":"public/static/img/emjoy/emjoy_31.gif","[emjoy_32]":"public/static/img/emjoy/emjoy_32.gif","[emjoy_33]":"public/static/img/emjoy/emjoy_33.gif","[emjoy_34]":"public/static/img/emjoy/emjoy_34.gif","[emjoy_35]":"public/static/img/emjoy/emjoy_35.gif","[emjoy_36]":"public/static/img/emjoy/emjoy_36.gif","[emjoy_37]":"public/static/img/emjoy/emjoy_37.gif","[emjoy_38]":"public/static/img/emjoy/emjoy_38.gif","[emjoy_39]":"public/static/img/emjoy/emjoy_39.gif","[emjoy_40]":"public/static/img/emjoy/emjoy_40.gif","[emjoy_41]":"public/static/img/emjoy/emjoy_41.gif","[emjoy_42]":"public/static/img/emjoy/emjoy_42.gif","[emjoy_43]":"public/static/img/emjoy/emjoy_43.gif","[emjoy_44]":"public/static/img/emjoy/emjoy_44.gif","[emjoy_45]":"public/static/img/emjoy/emjoy_45.gif","[emjoy_46]":"public/static/img/emjoy/emjoy_46.gif","[emjoy_47]":"public/static/img/emjoy/emjoy_47.gif"}}},"22cc":function(t,e,i){"use strict";(function(t){i("7a82");var o=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=o(i("c7eb")),a=o(i("1da1"));i("ac1f"),i("14d9"),i("b64b"),i("99af"),i("a434"),i("e9c4"),i("498a"),i("5319");var n=o(i("efa0")),r=o(i("85b8")),d=o(i("21ef")),c={components:{chatMessage:r.default},data:function(){return{emjoyList:d.default.emjoyList,emjoyShow:!1,chatMore:!1,formData:{content:"",goods_id:0,order_id:0,image:""},isNetWork:!1,send:!1,messageList:[],page:1,isAll:!1,isLoading:!1,showLoading:!1,jumpBottom:null,scrollTop:0,scrollPosition:0,siteId:0,skuId:0,orderId:0,siteName:"",shopInfo:{},orderdetail:{},userInfo:{},style:{},inputFirst:0,inputShow:!1,inputOffsetBottom:0,goodsDetails:{},startId:0,goods_type:{promotion_name:"",promotion_id:""},keyWordsConfig:{is_open:0}}},mixins:[n.default],computed:{chatBottom:function(){return this.emjoyShow||this.chatMore||this.inputShow}},onLoad:function(t){var e=this;t.sku_id&&(this.skuId=t.sku_id,this.getGoodsDetails(t.sku_id)),t.order_id&&(this.orderId=t.order_id,this.getOrderInfo(t.order_id)),(this.skuId||this.orderId)&&(this.send=!0),this.$on("upDOM",(function(){e.setPageScrollTo()})),t.type?this.goods_type.promotion_name=t.type:this.goods_type.promotion_name="",t.type_id?this.goods_type.promotion_id=t.type_id:this.goods_type.promotion_id="",uni.getStorageSync("token")?(this.getUserInfo(),this.getSiteInfo(),this.inputFirst=0,this.inputShow=!1,this.inputOffsetBottom=0,this.getKeyWordsConfig(),uni.setNavigationBarTitle({title:"商家客服"})):this.$util.redirectTo("/pages_tool/login/login")},onReady:function(){var t=this;uni.onKeyboardHeightChange((function(e){t.inputOffsetBottom=e.height,0===e.height&&(t.focus=!1)}))},methods:{onEditorReady:function(){uni.createSelectorQuery().select("#editor").context((function(t){})).exec()},onEditorinput:function(){var t=this;uni.createSelectorQuery().select("#editor").context((function(e){t.editorCtx=e.context,t.editorCtx.getContents({success:function(e){t.formData.content=e.html}})})).exec()},openChatMore:function(){var t=this;this.$util.isAndroid&&(this.inputShow=!1,this.inputFirst=1),this.chatMore=!this.chatMore,this.emjoyShow=!1,this.$nextTick((function(){t.setPageScrollTo()}))},getUserInfo:function(){var t=this;this.$api.sendRequest({url:"/api/member/info",success:function(e){0==e.code&&(t.userInfo=e.data)}})},getSiteInfo:function(){var t=this;this.$api.sendRequest({url:"/api/site/info",success:function(e){0==e.code&&(t.shopInfo=e.data)}})},getKeyWordsConfig:function(){var t=this;this.$api.sendRequest({url:"/servicer/api/chat/keyword",success:function(e){e.code>=0&&e.data&&(t.keyWordsConfig=e.data)}})},getGoodsDetails:function(t){var e=this;this.$api.sendRequest({url:"/api/goodssku/detail",data:{sku_id:t},success:function(t){t.code>=0&&(e.goodsDetails=t.data.goods_sku_detail)}})},getOrderInfo:function(e){var i=this;this.$api.sendRequest({url:"/api/order/detail",data:{order_id:e},success:function(e){e.code>=0&&(t("log",e,"resresresresresresresresres"," at pages_tool/chat/room.vue:264"),i.orderdetail=e.data)}})},getChatList:function(){if(this.isAll)this.isLoading=!1;else if(!this.isLoading){this.isLoading=!0,1==this.page&&(this.messageList=[]);var e;e=this.messageList.length;var i=this;this.$api.sendRequest({url:"/servicer/api/chat/dialogs",data:{servicer_id:this.servicer_id,page:this.page,limit:15,site_id:i.siteId},success:function(o){if(o.code>=0&&o.data){i.page+=1,o.data.list&&o.data.list.length<15&&(i.isAll=!0);var s=[],a=o.data.list;if(a.length)for(var n=0;n<a.length;n++){var r={};t("log",a[n]," at pages_tool/chat/room.vue:307"),0==a[n].content_type?(r.id=i.startId,r.content=0==a[n].type?a[n].consumer_say:a[n].servicer_say,r.isItMe=0==a[n].type,r.contentType="string",r.sendStatus=!0):1==a[n].content_type?(r.id=i.startId,r.isItMe=0==a[n].type,r.sku_id=a[n].goods_sku_id,r.sendStatus=!0,0==a[n].type?r.contentType="sendGood":r.contentType="goodssku"):2==a[n].content_type?(r.id=i.startId,r.isItMe=0==a[n].type,r.contentType="order",r.order_id=a[n].order_id,r.sendStatus=!0):3==a[n].content_type&&(r.id=i.startId,r.isItMe=0==a[n].type,r.contentType="image",r.image=0==a[n].type?a[n].consumer_say:a[n].servicer_say,r.sendStatus=!0),s.push(r),i.startId+=1}setTimeout((function(){if(i.page-1==1){if(i.skuId&&Object.keys(i.goodsDetails).length>0){var t={id:i.startId,isItMe:!0,contentType:"sendGood",goodsDetail:i.goodsDetails};s.push(t),i.startId+=1}if(i.orderId&&Object.keys(i.orderdetail).length>0){var o={id:i.startId,isItMe:!0,contentType:"sendOrder",orderDetail:i.orderdetail};s.push(o),i.startId+=1}}s.length&&(i.messageList=s.concat(i.messageList),i.$nextTick((function(){i.page-1==1?(setTimeout((function(){i.setPageScrollTo()}),1e3),i.isLoading=!1):(i.setPageScrollTo("#chat".concat(i.messageList.length-e)),i.isLoading=!1)})))}),500)}else this.$util.showToast({title:o.message})}})}},setPageScrollTo:function(t){if(t){var e=uni.createSelectorQuery().in(this).select(t);e.boundingClientRect((function(t){uni.pageScrollTo({scrollTop:t.top-30,duration:0})})).exec()}else{var i=uni.createSelectorQuery().in(this);i.select(".room").boundingClientRect((function(t){uni.pageScrollTo({scrollTop:t.height-30,duration:0})})).exec(),this.$refs.loadingCover&&this.$refs.loadingCover.hide()}},sendGood:function(t,e){this.sendMsg("goods"),this.messageList.splice(e,1)},sendOrder:function(t,e){this.sendMsg("order"),this.messageList.splice(e,1)},sendMsg:function(e){if(!this.isNetWork){this.isNetWork=!0;var i=this;if("goods"==e){var o={};""!=this.goods_type.promotion_id&&(o.promotion_id=this.goods_type.promotion_id,o.promotion_name=this.goods_type.promotion_name),this.$api.sendRequest({url:"/servicer/api/chat/say",data:{goods_id:this.skuId,servicer_id:this.servicer_id,content_type:1,site_id:this.siteId,relate_data:JSON.stringify(o)},success:function(t){i.send=!1,i.joinData("send","goods")},complete:function(){i.isNetWork=!1}})}else if("order"==e)this.$api.sendRequest({url:"/servicer/api/chat/say",data:{order_id:this.orderId,servicer_id:this.servicer_id,site_id:this.siteId,content_type:2},success:function(t){i.send=!1,i.joinData("send","order")},complete:function(){i.isNetWork=!1}});else if("image"==e)i.joinData("send","image"),this.$api.sendRequest({url:"/servicer/api/chat/say",data:{message:this.formData.image.trim(),servicer_id:this.servicer_id,site_id:this.siteId,content_type:3},success:function(e){t("log",e,"图片上传成功"," at pages_tool/chat/room.vue:496")},error:function(){var t=this;i.messageList[i.messageList.length-1].sendStatus=!1,uni.createSelectorQuery().select("#editor").context((function(e){t.editorCtx=e.context,t.editorCtx.clear()})).exec()},complete:function(){i.isNetWork=!1}});else{t("log",this.formData.content,"this.formData.content"," at pages_tool/chat/room.vue:514");var s=this.formData.content,a=s.replace(/<p>/,""),n=a.replace(/<\/p>/,""),r=n.replace(/<br>/,"");if("<p></p>"==s||"<p><br></p>"==s||!r.trim())return this.$util.showToast({title:"发送内容不能为空"}),uni.createSelectorQuery().select("#editor").context((function(t){i.editorCtx=t.context,i.editorCtx.clear()})).exec(),void(i.isNetWork=!1);i.joinData("send","string"),this.$api.sendRequest({url:"/servicer/api/chat/say",data:{message:this.formData.content,servicer_id:this.servicer_id,content_type:0},success:function(e){var o=this;0==e.code&&(t("log",e,"文字上传成功"," at pages_tool/chat/room.vue:544"),i.formData.content="<p></p>",uni.createSelectorQuery().select("#editor").context((function(t){o.editorCtx=t.context,o.editorCtx.clear()})).exec())},error:function(){var t=this;i.messageList[i.messageList.length-1].sendStatus=!1,uni.createSelectorQuery().select("#editor").context((function(e){t.editorCtx=e.context,t.editorCtx.clear()})).exec()},complete:function(){i.isNetWork=!1}})}}},joinData:function(t,e){var i=this;return(0,a.default)((0,s.default)().mark((function o(){var a;return(0,s.default)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:"send"==t&&(a={isItMe:!0,contentType:e,sendStatus:!0},"string"==e?a.content=i.formData.content:"order"==e?a.order_id=i.orderId:"goods"==e?a.sku_id=i.skuId:"image"==e&&(a.image=i.formData.image),i.messageList.push(a),i.$nextTick((function(){setTimeout((function(){i.setPageScrollTo()}),500)})));case 1:case"end":return o.stop()}}),o)})))()},hideLoadTips:function(t){var e=this;t?(this.ajax.loadText="消息获取成功",setTimeout((function(){e.ajax.loading=!1}),300)):(this.ajax.loading=!0,this.ajax.loadText="正在获取消息")},onPageScroll:function(t){0==t.scrollTop&&this.getChatList()},inputFocus:function(t){this.$util.isAndroid()&&this.inputFirst&&(this.inputShow=!0),this.chatMore=!1},closePopWindow:function(){this.inputFirst=0,this.chatMore=!1,this.inputShow=!1},openEmjoy:function(){var e=this;t("log",this.emjoyShow,"this.emjoyShow"," at pages_tool/chat/room.vue:633"),this.chatMore=!1,this.emjoyShow=!this.emjoyShow,this.$nextTick((function(){e.setPageScrollTo()}))},addEmjoy:function(e,i){var o=this;t("log",e,i," at pages_tool/chat/room.vue:648"),uni.createSelectorQuery().select("#editor").context((function(t){o.editorCtx=t.context,o.editorCtx.getContents({success:function(t){"<p><br></p>"==t.html&&(t.html="<p></p>");var i=o.$util.img(e),s='<img src="'+i+'" style="height=20px; width=20px; margin-left=20px;">',a=t.html.replace(/<\/p>$/,s+"</p>");o.editorCtx.setContents({html:a}),o.formData.content=a,o.emjoyShow=!1}})})).exec()},addImg:function(){var t=this;this.$util.upload(1,{path:"chatimg"},(function(e){if(!e[0])return t.$util.showToast({title:"上传失败！"}),!1;t.formData.image=e[0],t.sendMsg("image")}),"/servicer/api/chat/chatimg")}},beforeDestroy:function(){clearInterval(this.timeoutObj),this.timeoutObj=null,this.$api.sendRequest({url:"/servicer/api/chat/bye",data:{servicer_id:this.servicer_id,site_id:this.siteId},success:function(t){uni.closeSocket()}})}};e.default=c}).call(this,i("0de9")["log"])},"3a52":function(t,e,i){var o=i("a83d");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var s=i("4f06").default;s("893eebbe",o,!0,{sourceMap:!1,shadowMode:!1})},"3c5e":function(t,e,i){"use strict";i.r(e);var o=i("ca95"),s=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=s.a},4170:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o}));var o={pageMeta:i("6d42").default,loadingCover:i("ed27").default},s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("page-meta",{attrs:{"page-style":t.themeColor}}),i("v-uni-view",{staticClass:"container",attrs:{id:"container"}},[i("v-uni-view",{staticClass:"room",class:1==t.keyWordsConfig.is_open?"active":"",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopWindow.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"tips",class:{show:t.isLoading}},[t._v("正在获取消息")]),i("v-uni-view",{staticClass:"room-content-box"},t._l(t.messageList,(function(e,o){return i("v-uni-view",{key:o,attrs:{id:"chat"+o}},[i("chat-message",{attrs:{message:e,shopInfo:t.shopInfo,userInfo:t.userInfo,send:t.send},on:{sendGood:function(e){arguments[0]=e=t.$handleEvent(e),t.sendGood(e,o)},sendOrder:function(e){arguments[0]=e=t.$handleEvent(e),t.sendOrder(e,o)}}})],1)})),1),t.chatBottom?i("v-uni-view",{staticClass:"paddingbottom",attrs:{id:"paddingbottom"}}):t._e()],1),i("v-uni-view",{staticClass:"input-content",class:1==t.keyWordsConfig.is_open?"active":""},[1==t.keyWordsConfig.is_open?i("v-uni-view",{staticClass:"keyWords"},t._l(t.keyWordsConfig.keyword_list,(function(e,o){return i("v-uni-text",{key:o,on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.formData.content=e.keyword,t.sendMsg("message")}}},[t._v(t._s(e.keyword))])})),1):t._e(),i("v-uni-view",{staticClass:"input-box"},[i("v-uni-view",{staticClass:"iconfont icon-biaoqing padding-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openEmjoy()}}}),i("v-uni-editor",{staticClass:"message-edit",attrs:{id:"editor"},on:{ready:function(e){arguments[0]=e=t.$handleEvent(e),t.onEditorReady.apply(void 0,arguments)},focus:function(e){arguments[0]=e=t.$handleEvent(e),t.inputFocus.apply(void 0,arguments)},input:function(e){arguments[0]=e=t.$handleEvent(e),t.onEditorinput()},blur:function(e){arguments[0]=e=t.$handleEvent(e),t.closePopWindow()}},model:{value:t.formData.content,callback:function(e){t.$set(t.formData,"content",e)},expression:"formData.content"}}),i("v-uni-view",{staticClass:"iconfont icon-jiahao01 padding-right",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.openChatMore()}}}),i("v-uni-view",{staticClass:"send_btn color-base-bg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendMsg("message")}}},[t._v("发送")])],1),t.inputShow&&t.inputFirst?i("v-uni-view",{staticClass:"inputShow"}):t._e(),t.emjoyShow?i("v-uni-view",{on:{touchmove:function(e){e.preventDefault(),e.stopPropagation(),arguments[0]=e=t.$handleEvent(e)}}},[i("v-uni-view",{staticClass:"emjoy-box"},[i("v-uni-scroll-view",{staticClass:"emjoy-content",attrs:{"scroll-y":"true"}},t._l(t.emjoyList,(function(e,o){return i("v-uni-view",{key:o,staticClass:"emjoy-item",on:{click:function(i){arguments[0]=i=t.$handleEvent(i),t.addEmjoy(e,o)}}},[i("v-uni-image",{attrs:{src:t.$util.img(e)}})],1)})),1)],1)],1):t._e(),t.chatMore?i("v-uni-view",{staticClass:"more_send"},[i("v-uni-view",{staticClass:"more_send-item",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.addImg()}}},[i("v-uni-text",{staticClass:"iconfont icon-tupian"}),i("v-uni-view",[t._v("图片")])],1)],1):t._e()],1),i("loading-cover",{ref:"loadingCover"})],1)],1)},a=[]},"600d":function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n */.more_send[data-v-1a4dcae2]{display:flex;border-top:%?2?% solid #e5e5e5;height:%?390?%;flex-wrap:wrap}.more_send > uni-view[data-v-1a4dcae2]{padding-top:%?16?%;width:25%;height:%?156?%;text-align:center}.more_send > uni-view .iconfont[data-v-1a4dcae2]{display:inline;font-size:%?60?%;color:#333;background-color:#fff;border-radius:%?20?%;padding:%?20?%}.more_send > uni-view > uni-view[data-v-1a4dcae2]{color:#909399;font-size:%?22?%}.chat_send[data-v-1a4dcae2]{display:flex;height:%?90?%;justify-content:space-between;position:relative}.chat_send .send[data-v-1a4dcae2]{position:absolute;right:%?30?%;bottom:%?30?%;color:#fff;align-self:flex-end;font-size:%?28?%;padding:%?10?% %?20?%;border-radius:%?8?%}.chat_send .emjoy_list[data-v-1a4dcae2]{flex:1}\n/* 加载数据提示 */.tips[data-v-1a4dcae2]{position:fixed;left:0;top:var(--window-top);width:100%;z-index:9;background-color:transparent;height:%?72?%;line-height:%?72?%;-webkit-transform:translateY(%?-80?%);transform:translateY(%?-80?%);transition:-webkit-transform .3s ease-in-out 0s;transition:transform .3s ease-in-out 0s;transition:transform .3s ease-in-out 0s,-webkit-transform .3s ease-in-out 0s;font-size:%?24?%;text-align:center;line-height:%?72?%}.tips.show[data-v-1a4dcae2]{-webkit-transform:translateY(0);transform:translateY(0)}.room[data-v-1a4dcae2]{width:100%;min-height:calc(100vh - %?48?%);padding-bottom:calc(%?110?% + %?88?%);padding-bottom:calc(%?110?% + %?88?% + constant(safe-area-inset-bottom));padding-bottom:calc(%?110?% + %?88?% + env(safe-area-inset-bottom));box-sizing:border-box}.room .room-content-box[data-v-1a4dcae2]{width:100%;min-height:calc(100% + %?20?%);padding-top:%?20?%;box-sizing:border-box}.paddingbottom[data-v-1a4dcae2]{height:calc(%?280?% + %?88?%)}.emjoy-box[data-v-1a4dcae2]{width:100%;height:%?300?%;padding:%?20?% %?25?%;box-sizing:border-box;background:#f4f4f4;border-top:%?1?% solid #e5e5e5}.emjoy-box .emjoy-content[data-v-1a4dcae2]{width:100%;height:100%}.emjoy-box .emjoy-content .emjoy-item[data-v-1a4dcae2]{display:inline-block;width:%?100?%;height:%?70?%;text-align:center;line-height:%?70?%}.emjoy-box .emjoy-content .emjoy-item uni-image[data-v-1a4dcae2]{display:inline-block;width:%?40?%;height:%?40?%}.input-content[data-v-1a4dcae2]{background:#f4f4f4;width:100%;min-height:%?110?%;position:fixed;left:0;bottom:0;padding-bottom:0;padding-bottom:constant(safe-area-inset-bottom);padding-bottom:env(safe-area-inset-bottom)}.input-content.active[data-v-1a4dcae2]{min-height:%?180?%!important}.input-content .keyWords[data-v-1a4dcae2]{height:%?60?%;line-height:%?60?%;padding:%?20?% 0 0;overflow-x:scroll;display:flex;margin-left:%?20?%;margin-right:%?20?%}.input-content .keyWords uni-text[data-v-1a4dcae2]{font-size:%?24?%;margin-right:%?20?%;height:%?28?%;line-height:%?28?%;padding:%?10?% %?16?%;background-color:#fff;border-radius:%?10?%;white-space:nowrap}.input-content .input-box[data-v-1a4dcae2]{width:100%;height:auto;display:flex;justify-content:space-between;align-items:center;padding:%?10?% %?20?%;box-sizing:border-box}.input-content .input-box .iconfont[data-v-1a4dcae2]{line-height:1;font-size:%?52?%;padding:%?15?%}.input-content .input-box .send_btn[data-v-1a4dcae2]{font-size:%?24?%;min-width:%?80?%;text-align:center;background-color:#e8e8e8;color:#fff;border-radius:%?8?%;height:%?50?%;line-height:%?50?%}.input-content .input-box .message-edit[data-v-1a4dcae2]{padding:%?4?% %?15?%;line-height:1.5;background-color:#fff;min-height:%?60?%!important;height:auto!important;border-radius:%?30?%;font-size:%?28?%}',""]),t.exports=e},6397:function(t,e,i){"use strict";i("7a82");var o=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("4d63"),i("c607"),i("ac1f"),i("2c3e"),i("25f0"),i("00b4"),i("5319"),i("d3b7"),i("159b");var s=o(i("9be5")),a=o(i("871a")),n=o(i("c885")),r=o(i("1247")),d=o(i("4e20")),c=o(i("21ef")),u={name:"chat-message",props:{message:{type:Object},shopInfo:{type:Object},userInfo:{type:Object},send:{type:Boolean}},data:function(){return{avatar:"",defaultAvatar:this.$util.getDefaultImage().store,myHeadImg:"",defaultHead:this.$util.getDefaultImage().head,emjoyList:c.default.emjoyList,currImg:""}},components:{nsChatGoods:s.default,nsChatOrder:a.default,uniPopup:d.default,nsChatReceiveGoods:n.default},mounted:function(){this.avatar=this.$util.img(this.shopInfo.logo_square),this.myHeadImg=this.$util.img(this.userInfo.headimg)},methods:{previewMedia:function(t){var e=[t];uni.previewImage({current:0,urls:e})},sendGood:function(){this.$emit("sendGood","goods")},sendOrder:function(){this.$emit("sendOrder","order")},myHeadImgError:function(){this.myHeadImg=this.defaultHead},stringToEmjoy:function(t){var e=this;if(t){var i=RegExp(/\[/);if(i.test(t)){var o=t,s=new RegExp("\\[emjoy_(.+?)\\]","g"),a=o.replace(s,(function(t){var i="";for(var o in e.emjoyList)if(t==o){var s=e.$util.img(e.emjoyList[o]);i="<img class='message-img' src='"+s+"'/>";break}return i||t})),n=(0,r.default)(a);return n.forEach((function(t){"img"==t.name&&(t.attrs.style="display: inline-block;width: 32rpx !important;height: 32rpx !important;padding:0 2rpx;")})),n}var d=t;return d}}}};e.default=u},"6d42":function(t,e,i){"use strict";i.r(e);var o=i("6ee6"),s=i("8f28");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);var n=i("f0c5"),r=Object(n["a"])(s["default"],o["b"],o["c"],!1,null,null,null,!1,o["a"],void 0);e["default"]=r.exports},"6ee6":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var o=function(){var t=this.$createElement,e=this._self._c||t;return e("v-uni-view",{staticStyle:{display:"none"}},[this._t("default")],2)},s=[]},"706f":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"goods"},[i("v-uni-view",{staticClass:"goods-msg"},[i("v-uni-image",{attrs:{src:t.$util.img(t.goodsINfo.sku_image),mode:"aspectFill"}}),i("v-uni-view",{staticClass:"goods-item"},[i("v-uni-view",{staticClass:"title"},[t._v(t._s(t.goodsINfo.goods_name))]),i("v-uni-view",{staticClass:"goods-sku"},[t._v("库存:"+t._s(t.goodsINfo.stock)),i("v-uni-text",[t._v("销量:"+t._s(t.goodsINfo.sale_num))])],1),i("v-uni-view",{staticClass:"goods-price"},[i("v-uni-view",{staticClass:"price color-base-text"},[i("v-uni-text",{staticClass:"price-util"},[t._v("￥")]),i("v-uni-text",{staticClass:"price-num"},[t._v(t._s(t.goodsINfo.price))])],1),i("v-uni-view",{staticClass:"see-shop color-base-text",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.go_shop()}}},[t._v("查看商品"),i("v-uni-text",{staticClass:"iconfont icon-right"})],1)],1)],1)],1)],1)},s=[]},"7a81":function(t,e,i){"use strict";i.r(e);var o=i("22cc"),s=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=s.a},"7cd1":function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n */.goods[data-v-4ba028d8]{padding:%?13?% %?20?%;box-sizing:border-box;width:100vw;position:relative}.goods .goods-msg[data-v-4ba028d8]{width:100%;height:%?220?%;background:#fff;position:relative;display:flex;align-items:center;border-radius:%?20?%;margin:0 auto;padding:%?20?%;box-sizing:border-box}.goods .goods-msg uni-image[data-v-4ba028d8]{width:%?180?%;height:%?180?%;min-width:%?180?%;border-radius:%?10?%}.goods .goods-msg .goods-item[data-v-4ba028d8]{width:100%;height:%?180?%;display:flex;flex-direction:column;justify-content:space-between;padding-left:%?20?%;box-sizing:border-box}.goods .goods-msg .goods-item .title[data-v-4ba028d8]{width:100%;line-height:1.4;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.goods .goods-msg .goods-item .goods-sku[data-v-4ba028d8]{color:#606266}.goods .goods-msg .goods-item .goods-sku uni-text[data-v-4ba028d8]{padding-left:%?20?%}.goods .goods-msg .goods-item .goods-price[data-v-4ba028d8]{display:flex;align-items:center;justify-content:space-between}.goods .goods-msg .goods-item .goods-price .price .price-util[data-v-4ba028d8]{font-size:%?20?%}.goods .goods-msg .goods-item .goods-price .see-shop[data-v-4ba028d8]{display:flex;align-items:center}.goods .goods-msg .goods-item .goods-price .see-shop uni-text[data-v-4ba028d8]{padding-top:%?4?%;padding-left:%?4?%;font-size:%?26?%}',""]),t.exports=e},"801d":function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"message"},[t.orderdetails?i("v-uni-view",{staticClass:"goods-item"},[i("v-uni-image",{attrs:{src:t.$util.img(t.orderdetails.order_goods?t.orderdetails.order_goods[0].sku_image:""),mode:"aspectFill"}}),i("v-uni-view",{staticClass:"goods-info"},[i("v-uni-view",{staticClass:"goods-name"},[t._v(t._s(t.orderdetails.order_goods?t.orderdetails.order_goods[0].sku_name:""))]),i("v-uni-view",{staticClass:"font-size-goods-tag"},[t._v("订单状态:"+t._s(t.orderdetails.order_status_name))]),i("v-uni-view",{staticClass:"font-size-goods-tag"},[t._v("配送方式:"+t._s(t.orderdetails.delivery_type_name))]),i("v-uni-view",{staticClass:"goods-bottom"},[i("v-uni-view",{staticClass:"goods-price color-base-text"},[i("v-uni-text",{staticClass:"goods-price-sign"},[t._v("￥")]),i("v-uni-text",[t._v(t._s(t.orderdetails.order_goods?t.orderdetails.order_goods[0].price:""))])],1),i("v-uni-view",{staticClass:"goods-option font-size-goods-tag color-base-bg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendMsg("order")}}},[t._v("发送")])],1)],1)],1):t.orderInfo?i("v-uni-view",{staticClass:"goods-item"},[i("v-uni-image",{attrs:{src:t.$util.img(t.orderInfo.order_goods?t.orderInfo.order_goods[0].sku_image:""),mode:"aspectFill"}}),i("v-uni-view",{staticClass:"goods-info"},[i("v-uni-view",{staticClass:"goods-name"},[t._v(t._s(t.orderInfo.order_goods?t.orderInfo.order_goods[0].sku_name:""))]),i("v-uni-view",{staticClass:"font-size-goods-tag"},[t._v("订单状态:"+t._s(t.orderInfo.order_status_name))]),i("v-uni-view",{staticClass:"font-size-goods-tag"},[t._v("配送方式:"+t._s(t.orderInfo.delivery_type_name))]),i("v-uni-view",{staticClass:"goods-bottom"},[i("v-uni-view",{staticClass:"goods-price color-base-text"},[i("v-uni-text",{staticClass:"goods-price-sign"},[t._v("￥")]),i("v-uni-text",[t._v(t._s(t.orderInfo.order_goods?t.orderInfo.order_goods[0].price:""))])],1),i("v-uni-view",{staticClass:"goods-option font-size-goods-tag disabled"},[t._v("已发送")])],1)],1)],1):t._e()],1)},s=[]},"85b8":function(t,e,i){"use strict";i.r(e);var o=i("c52b"),s=i("d28e");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("f58e");var n=i("f0c5"),r=Object(n["a"])(s["default"],o["b"],o["c"],!1,null,"4489a812",null,!1,o["a"],void 0);e["default"]=r.exports},"871a":function(t,e,i){"use strict";i.r(e);var o=i("801d"),s=i("3c5e");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("9b8e");var n=i("f0c5"),r=Object(n["a"])(s["default"],o["b"],o["c"],!1,null,"6600fb05",null,!1,o["a"],void 0);e["default"]=r.exports},"8e2f":function(t,e,i){"use strict";i.r(e);var o=i("02e8"),s=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=s.a},"8f28":function(t,e,i){"use strict";i.r(e);var o=i("013c"),s=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=s.a},"9b8e":function(t,e,i){"use strict";var o=i("dc5b"),s=i.n(o);s.a},"9be5":function(t,e,i){"use strict";i.r(e);var o=i("e5cf7"),s=i("8e2f");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("1fd3");var n=i("f0c5"),r=Object(n["a"])(s["default"],o["b"],o["c"],!1,null,"d5ca9fc6",null,!1,o["a"],void 0);e["default"]=r.exports},a4df:function(t,e,i){"use strict";var o=i("b35f"),s=i.n(o);s.a},a83d:function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n */.message[data-v-d5ca9fc6]{padding:%?13?% %?20?%;box-sizing:border-box;width:100vw;position:relative}.message .goods-item[data-v-d5ca9fc6]{width:100%;height:%?220?%;background:#fff;position:relative;display:flex;align-items:center;border-radius:%?20?%;margin:0 auto;padding:%?20?%;box-sizing:border-box}.message .goods-item uni-image[data-v-d5ca9fc6]{width:%?180?%;height:%?180?%;min-width:%?180?%}.message .goods-item .goods-info[data-v-d5ca9fc6]{width:100%;height:%?180?%;display:flex;flex-direction:column;justify-content:space-between;padding-left:%?20?%;box-sizing:border-box}.message .goods-item .goods-info .goods-name[data-v-d5ca9fc6]{width:100%;line-height:1.4;display:-webkit-box;-webkit-box-orient:vertical;-webkit-line-clamp:2;overflow:hidden}.message .goods-item .goods-info .goods-bottom[data-v-d5ca9fc6]{display:flex;justify-content:space-between;align-items:flex-end}.message .goods-item .goods-info .goods-bottom uni-text[data-v-d5ca9fc6]{line-height:1}.message .goods-item .goods-info .goods-bottom .goods-price[data-v-d5ca9fc6]{display:flex;align-items:flex-end;padding-bottom:%?10?%;font-weight:500}.message .goods-item .goods-info .goods-bottom .goods-price .goods-price-sign[data-v-d5ca9fc6]{font-size:%?20?%}.message .goods-item .goods-info .goods-bottom .goods-option[data-v-d5ca9fc6]{width:%?150?%;height:%?50?%;line-height:%?50?%;text-align:center;border-radius:%?10?%;color:#fff}.message .goods-item .disabled[data-v-d5ca9fc6]{background:#e5e5e5}',""]),t.exports=e},b35f:function(t,e,i){var o=i("7cd1");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var s=i("4f06").default;s("741376a1",o,!0,{sourceMap:!1,shadowMode:!1})},b4b9:function(t,e,i){"use strict";i.r(e);var o=i("4170"),s=i("7a81");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("df33");var n=i("f0c5"),r=Object(n["a"])(s["default"],o["b"],o["c"],!1,null,"1a4dcae2",null,!1,o["a"],void 0);e["default"]=r.exports},c52b:function(t,e,i){"use strict";i.d(e,"b",(function(){return s})),i.d(e,"c",(function(){return a})),i.d(e,"a",(function(){return o}));var o={uniPopup:i("4e20").default},s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"chat-message"},["sendGood"==t.message.contentType?[i("ns-chat-goods",{attrs:{skuId:t.message.sku_id,goodsDetail:t.message.goodsDetail},on:{sendMsg:function(e){arguments[0]=e=t.$handleEvent(e),t.sendGood.apply(void 0,arguments)}}})]:t._e(),"sendOrder"==t.message.contentType?[i("ns-chat-order",{attrs:{orderId:t.message.order_id,orderdetails:t.message.orderDetail},on:{sendMsg:function(e){arguments[0]=e=t.$handleEvent(e),t.sendOrder.apply(void 0,arguments)}}})]:t._e(),"goodssku"==t.message.contentType?[i("ns-chat-receiveGoods",{attrs:{skuId:t.message.sku_id}})]:t._e(),"string"==t.message.contentType?i("v-uni-view",{staticClass:"message"},[i("v-uni-view",{staticClass:"message-item",class:t.message.isItMe?"right":"left"},[t.message.isItMe?[i("v-uni-view",{staticClass:"head_img"},[t.myHeadImg?i("v-uni-image",{staticClass:"img",attrs:{src:t.myHeadImg,mode:"aspectFit"},on:{error:function(e){arguments[0]=e=t.$handleEvent(e),t.myHeadImgError.apply(void 0,arguments)}}}):i("v-uni-image",{staticClass:"img",attrs:{src:t.defaultHead,mode:"aspectFit"}})],1)]:[i("v-uni-view",{staticClass:"head_img"},[t.avatar?i("v-uni-image",{staticClass:"img",attrs:{src:t.avatar,mode:"aspectFit"}}):i("v-uni-image",{staticClass:"img",attrs:{src:t.defaultHead,mode:"aspectFit"}})],1)],i("v-uni-view",{staticClass:"chat_text"},[t.message.isItMe&&!t.message.sendStatus?i("v-uni-text",{staticClass:"iconfont icon-warn margin-right color-base-text"}):t._e(),i("v-uni-view",{staticClass:"content"},[i("v-uni-rich-text",{attrs:{nodes:t.stringToEmjoy(t.message.content)}})],1)],1)],2)],1):t._e(),"image"==t.message.contentType?i("v-uni-view",{staticClass:"message"},[i("v-uni-view",{staticClass:"message-item",class:t.message.isItMe?"right":"left"},[t.message.isItMe?[i("v-uni-view",{staticClass:"head_img"},[t.myHeadImg?i("v-uni-image",{staticClass:"img",attrs:{src:t.myHeadImg,mode:"aspectFit"}}):i("v-uni-image",{staticClass:"img",attrs:{src:t.defaultHead,mode:"aspectFit"}})],1)]:[i("v-uni-view",{staticClass:"head_img"},[t.avatar?i("v-uni-image",{staticClass:"img",attrs:{src:t.avatar,mode:"aspectFit"}}):i("v-uni-image",{staticClass:"img",attrs:{src:t.defaultHead,mode:"aspectFit"}})],1)],i("v-uni-view",{staticClass:"chat_img"},[t.message.isItMe&&!t.message.sendStatus?i("v-uni-text",{staticClass:"iconfont icon-warn margin-right color-base-text"}):t._e(),i("v-uni-view",{staticClass:"content_img",style:{backgroundImage:"url("+t.$util.img(t.message.image)+")"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewMedia(t.$util.img(t.message.image))}}})],1)],2)],1):"goods"==t.message.contentType?i("v-uni-view",[i("ns-chat-goods",{attrs:{isCanSend:!1,skuId:t.message.sku_id}})],1):"order"==t.message.contentType?i("v-uni-view",[i("ns-chat-order",{attrs:{isCanSend:!1,orderId:t.message.order_id}})],1):t._e(),"noline"==t.message.contentType?i("v-uni-view",{staticClass:"no-connect-box"},[i("v-uni-view",{staticClass:"no-connect"},[t._v("客服不在线")])],1):t._e(),"online"==t.message.contentType?i("v-uni-view",{staticClass:"no-connect-box"},[i("v-uni-view",{staticClass:"no-connect"},[t._v("客服在线")])],1):t._e(),i("uni-popup",{ref:"imgPopup",attrs:{type:"center"}},[i("v-uni-view",{staticClass:"imagePop"},[i("v-uni-image",{attrs:{src:t.$util.img(t.currImg),mode:"aspectFit"}})],1)],1)],2)},a=[]},c885:function(t,e,i){"use strict";i.r(e);var o=i("706f"),s=i("efd9");for(var a in s)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return s[t]}))}(a);i("a4df");var n=i("f0c5"),r=Object(n["a"])(s["default"],o["b"],o["c"],!1,null,"4ba028d8",null,!1,o["a"],void 0);e["default"]=r.exports},ca95:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("a9e3");var o={name:"ns-chat-order",props:{orderId:{type:[Number,String]},isCanSend:Boolean,orderdetails:{type:[Object]}},data:function(){return{orderInfo:{}}},mounted:function(){this.getGoodsInfo()},methods:{getGoodsInfo:function(){var t=this;this.orderId&&this.$api.sendRequest({url:"/api/order/detail",data:{order_id:this.orderId},success:function(e){e.code>=0&&(t.orderInfo=e.data)}})},sendMsg:function(){this.$emit("sendMsg","order")}}};e.default=o},d28e:function(t,e,i){"use strict";i.r(e);var o=i("6397"),s=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=s.a},dc5b:function(t,e,i){var o=i("1e21");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var s=i("4f06").default;s("614dd973",o,!0,{sourceMap:!1,shadowMode:!1})},de8a:function(t,e,i){var o=i("600d");o.__esModule&&(o=o.default),"string"===typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);var s=i("4f06").default;s("7593f6b6",o,!0,{sourceMap:!1,shadowMode:!1})},df33:function(t,e,i){"use strict";var o=i("de8a"),s=i.n(o);s.a},e5cf7:function(t,e,i){"use strict";i.d(e,"b",(function(){return o})),i.d(e,"c",(function(){return s})),i.d(e,"a",(function(){}));var o=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"message"},[t.goodsInfo.goods_name?i("v-uni-view",{staticClass:"goods-item"},[i("v-uni-image",{attrs:{src:t.$util.img(t.goodsInfo.sku_image),mode:"aspectFill"}}),i("v-uni-view",{staticClass:"goods-info"},[i("v-uni-view",{staticClass:"goods-name"},[t._v(t._s(t.goodsInfo.sku_name?t.goodsInfo.sku_name:t.goodsInfo.goods_name))]),i("v-uni-view",{staticClass:"goods-bottom"},[i("v-uni-view",{staticClass:"goods-price"},[i("v-uni-text",{staticClass:"goods-price-sign color-base-text"},[t._v("￥")]),i("v-uni-text",{staticClass:"color-base-text"},[t._v(t._s(t.goodsInfo.price))])],1),i("v-uni-view",{staticClass:"goods-option font-size-goods-tag disabled"},[t._v("已发送")])],1)],1)],1):t.goodsDetail?i("v-uni-view",{staticClass:"goods-item"},[i("v-uni-image",{attrs:{src:t.$util.img(t.goodsDetail.sku_image),mode:"aspectFill"}}),i("v-uni-view",{staticClass:"goods-info"},[i("v-uni-view",{staticClass:"goods-name"},[t._v(t._s(t.goodsDetail.sku_name?t.goodsDetail.sku_name:t.goodsDetail.goods_name))]),i("v-uni-view",{staticClass:"goods-bottom"},[i("v-uni-view",{staticClass:"goods-price"},[i("v-uni-text",{staticClass:"goods-price-sign color-base-text"},[t._v("￥")]),i("v-uni-text",{staticClass:"color-base-text"},[t._v(t._s(t.goodsDetail.price))])],1),i("v-uni-view",{staticClass:"goods-option font-size-goods-tag color-base-bg",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.sendMsg("goods")}}},[t._v("发送")])],1)],1)],1):t._e()],1)},s=[]},efa0:function(t,e,i){"use strict";(function(t){i("7a82");var o=i("4ea4").default;Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("14d9");var s=o(i("f5f4")),a={data:function(){return{timeoutObj:null,servicer_id:null,pingInterval:s.default.pingInterval}},onLoad:function(){uni.closeSocket(),this.checkOpenSocket()},methods:{checkOpenSocket:function(){t("log","判断是否已连接"," at common/js/socketTest.js:23");var e=this;uni.sendSocketMessage({data:"ping",success:function(e){t("log","连接成功,检查"," at common/js/socketTest.js:29")},fail:function(i){t("log","连接失败"," at common/js/socketTest.js:36"),e.openConnection()}})},openConnection:function(){t("log","打开连接"," at common/js/socketTest.js:44"),uni.connectSocket({url:s.default.webSocket,method:"POST",success:function(e){t("log","连接成功 connectSocket=",e," at common/js/socketTest.js:51")},fail:function(e){t("log","连接失败 connectSocket=",e," at common/js/socketTest.js:55")}}),this.onSocketMessage()},onSocketMessage:function(){var e=this;t("log","开始监听"," at common/js/socketTest.js:66");var i=this;this.pingInterval=s.default.pingInterval,this.timeoutObj=null,uni.onSocketMessage((function(o){var s=JSON.parse(o.data);if(t("log","监听该服务器消息",o," at common/js/socketTest.js:74"),"close"==s.type)return clearInterval(i.timeoutObj),i.timeoutObj=null,void uni.closeSocket();e.reset(),e.getSocketMsg(o.data)}))},getSocketMsg:function(t){var e=this,i=JSON.parse(t),o={isItMe:!1};if(o.contentType=i.type,"init"==i.type)e.$api.sendRequest({url:"/servicer/api/chat/bind",data:{client_id:i.data.client_id,site_id:e.siteId},success:function(t){0==t.code?e.servicer_id=t.data.servicer_id:e.servicer_id=0,e.getChatList()}});else{if("connect"==i.type)return!1;"string"==i.type?o.content=i.data.servicer_say:"image"==i.type?o.image=i.data.servicer_say:"order"==i.type?o.order_id=i.data.order_id:"goodssku"==i.type&&(o.sku_id=i.data.goods_sku_id)}"init"!=i.type&&(e.messageList.push(o),e.$nextTick((function(){e.setPageScrollTo()})))},reset:function(){t("log","检测心跳"," at common/js/socketTest.js:149"),clearInterval(this.timeoutObj),this.start()},start:function(){t("log","启动心跳"," at common/js/socketTest.js:155");var e=this;this.timeoutObj=setInterval((function(){uni.sendSocketMessage({data:"ping",success:function(e){t("log","连接中...."," at common/js/socketTest.js:161")},fail:function(i){t("log","连接失败重新连接...."," at common/js/socketTest.js:164"),e.openConnection()}})}),this.pingInterval)}},onUnload:function(){clearInterval(this.timeoutObj),this.timeoutObj=null,this.$api.sendRequest({url:"/servicer/api/chat/bye",data:{servicer_id:this.servicer_id,site_id:this.siteId},success:function(t){uni.closeSocket()},fail:function(t){uni.closeSocket()}})}};e.default=a}).call(this,i("0de9")["log"])},efd9:function(t,e,i){"use strict";i.r(e);var o=i("fcaa"),s=i.n(o);for(var a in o)["default"].indexOf(a)<0&&function(t){i.d(e,t,(function(){return o[t]}))}(a);e["default"]=s.a},f3b4:function(t,e,i){var o=i("24fb");e=o(!1),e.push([t.i,'@charset "UTF-8";\n/**\n * 你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\n * 建议使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\n */[data-v-4489a812] .uni-popup__wrapper.uni-custom .uni-popup__wrapper-box{background-color:#000}[data-v-4489a812] .uni-popup__wrapper.uni-custom.center .uni-popup__wrapper-box{max-width:100%;width:100%}.imagePop[data-v-4489a812]{height:50vh;width:100vw;text-align:center}.imagePop uni-image[data-v-4489a812]{width:100%;height:100%}.chat-message[data-v-4489a812]{width:100%;height:100%}.chat-message .message[data-v-4489a812]{padding:%?13?% %?20?%;position:relative}.chat-message .left .content[data-v-4489a812]{padding:%?20?%;max-width:%?450?%;border-radius:%?10?%;font-size:%?30?%}.chat-message .right .content[data-v-4489a812]{padding:%?20?%;max-width:%?450?%;border-radius:%?10?%;font-size:%?30?%}.chat-message .content_img[data-v-4489a812]{height:%?200?%;width:100%;overflow:hidden;text-align:right;margin-left:%?28?%;background-position:100%;background-repeat:no-repeat;background-size:contain}.chat-message .content_img uni-image[data-v-4489a812]{min-height:%?80?%;min-width:%?80?%;height:100%;width:100%}.chat-message .right .content_img[data-v-4489a812]{margin-right:%?28?%;margin-left:0}.chat-message .message-item[data-v-4489a812]{display:flex;justify-content:flex-start;align-items:flex-start;align-content:flex-start;flex-wrap:nowrap;flex-direction:row}.chat-message .message-item .head_img[data-v-4489a812]{width:%?80?%;height:%?80?%;border-radius:50%;overflow:hidden;position:relative}.chat-message .message-item .head_img .img[data-v-4489a812]{width:100%;height:100%}.chat-message .message-item .contentType3[data-v-4489a812]{padding:0;border-radius:%?2?%;background-color:initial!important}.chat-message .message-item .contentType3 .img[data-v-4489a812]{width:%?200?%;height:auto;max-width:%?300?%;max-height:%?400?%}.chat-message .message-item .contentType3[data-v-4489a812]::after{border:none!important;display:none!important}.chat-message .message-item .content-type-right[data-v-4489a812]{flex-direction:row-reverse}.chat-message .message-item.right[data-v-4489a812]{flex-direction:row-reverse}.chat-message .message-item.right .content[data-v-4489a812]{background-color:#4cd964;margin-right:%?28?%;word-break:break-all;line-height:%?36?%;position:relative}.chat-message .message-item.left .content[data-v-4489a812]{background-color:#fff;margin-left:%?28?%;word-break:break-all;line-height:%?36?%;position:relative}.chat-message .next[data-v-4489a812]{width:100%;height:%?20?%}.no-connect-box[data-v-4489a812]{width:100%;text-align:center;margin:%?20?% 0 %?50?%}.no-connect-box .no-connect[data-v-4489a812]{display:inline-block;padding:0 %?20?%;height:%?40?%;background:red;margin:0 auto;background:rgba(0,0,0,.5);border-radius:%?9?%;text-align:center;line-height:%?40?%;font-size:%?22?%;color:#fff}.chat_text[data-v-4489a812],\n.chat_img[data-v-4489a812]{display:flex;align-items:center}.chat_text .iconfont[data-v-4489a812],\n.chat_img .iconfont[data-v-4489a812]{font-size:%?36?%}.chat_img[data-v-4489a812]{width:30%;height:%?200?%}',""]),t.exports=e},f58e:function(t,e,i){"use strict";var o=i("1595"),s=i.n(o);s.a},fcaa:function(t,e,i){"use strict";i("7a82"),Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,i("a9e3");var o={name:"ns-chat-receiveGoods",props:{skuId:{type:[Number,String]}},data:function(){return{goodsINfo:{}}},mounted:function(){this.getInfo()},methods:{getInfo:function(){var t=this;this.$api.sendRequest({url:"/api/goodssku/detail",data:{sku_id:this.skuId},success:function(e){e.code>=0&&(t.goodsINfo=e.data.goods_sku_detail,t.$emit("upDOM"))}})},go_shop:function(){this.$util.redirectTo("/pages/goods/detail?goods_id="+this.goodsINfo.goods_id)}}};e.default=o}}]);